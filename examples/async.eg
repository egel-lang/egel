# Egel supports asynchronous tasks
# async f       - start task f
# await f       - block pending a result
# is_valid f    - inspect whether f reduced

import "prelude.eg"

using System
using List

def wait_for =
    [ F -> if is_valid F then await F else print "o"; wait_for F ]

def main =
    let F = async [_ -> from_to 1 1000000 |> sum ] in
    wait_for F
